import numpy as np
import matplotlib.pyplot as plt

# Crear un array de 10x10 lleno de ceros
def createMaze(x, y):
    MAZE = np.zeros((x, y))
    MAZE[0, :] = 1
    MAZE[-1, :] = 1
    MAZE[:, 0] = 1
    MAZE[:, -1] = 1
    return MAZE
MAZE = createMaze(10, 10)
MARK = MAZE[:]
                  #[y, x]
MOVE = np.array([ [0,-1], [1,0], [0, 1], [-1, 0], [1,1], [-1,1], [-1,-1], [1,-1] ])  # izquierda, abajo, derecha, arriba, abajo-derecha, arriba-derecha, arriba-izquierda, abajo-izquierda

def dfs(walker, mark, visited:set, blackList:set):
    neighCells= neighbors(walker.x, walker.y)
    if (walker.y, walker.x) == (goal.y, goal.x):
        print("Encontrado")
        return True
    if len(neighCells) == 1 or ( len(neighCells) == 2 and (any(i in neighCells) for i in blacklist)):
        blackList.add((walker.y, walker.x))
        return dfs(walker, mark, visited, blackList)
    visited.add((walker.y, walker.x))
    
    for direccion in range(len(MOVE)):
        new_x = walker.x + MOVE[direccion,1]
        new_y = walker.y + MOVE[direccion,0]
        print(f"neighbors({walker.y}, {walker.x}):", neighCells)
        if mark[new_y, new_x] != 1 and (new_y, new_x) not in blackList: # Asegúrate de que no se salga de los límites y no sea un obstáculo
            if mark[new_y, new_x] == 0:

                walker.mover(direccion, MARK)
                if dfs(walker, mark, visited, blackList):
                    return True
            elif mark[new_y, new_x] == 3 and 0 not in neighCells:
                walker.mover(direccion, MARK)
                if dfs(walker, mark, visited, blackList):
                    return True
    
    return False

def neighbors(x, y):
    result = []
    for dy, dx in MOVE:
        result.append((int(x + dx), int(y + dy)))
    return result

class Agente:
    def __init__(self, x, y, color, traceColor=0):
        self.x = x
        self.y = y
        self.color = color
        self.trace = traceColor
        MARK[self.y, self.x] = self.color

    def mover(self, direccion, mark):
        print(mark)
        mark[self.y, self.x] = self.trace
        self.x += MOVE[direccion, 1]
        self.y += MOVE[direccion, 0]
        # print(f"New x: {self.x}, New y: {self.y}")
        mark[self.y, self.x] = self.color #Esto es para que marque de color donde ya hemnos estado

class Place: 
    def __init__(self, fila, columna):
        self.fila = fila
        self.columna = columna
    def mostrar(self):
        print("( " + self.fila+ "," +self.columna+")")

walker = Agente(1, 1, 2, 3)  #Este recorrerá el laberinto en busca de la meta
goal =   Agente(8, 8, 4)  #Este será la meta
# walker.mover(2, MARK)
dfs(walker, MARK, set(), set())
def visualize_example(x): 
    plt.figure()
    plt.imshow(x)
    plt.colorbar()
    plt.grid(False)
    plt.show()
visualize_example(MARK)